{
  "title": "Creating a Chrome Extension Without Much Effort",
  "preview": "Honestly, I thought that Chrome extensions were more effort than they were worth to develop. I thought my extension would have to be useful for other people on the Chrome Web Store. Here's how I was wrong.",
  "slug": "creating-a-chrome-extension-without-much-effort",
  "tags": [
    "javascript",
    "browser"
  ],
  "bodyContent": "![wide: My baby Chrome extension](hero.jpg)\n\nHonestly, I thought that Chrome extensions were more effort than they were worth to develop. I thought my extension would have to be useful for other people on the Chrome Web Store. Here‚Äôs how I was wrong.\n\n*Skip to ‚ÄúMaking the Extension‚Äù if you just want the goods.*\n\n# The Use Case\n\nI work at [The Zebra](https://www.thezebra.com/). It‚Äôs a neat place with smart software engineers collaborating on interesting problems.\n\nAny place that has software engineers has people griping and sniping about their tools. We‚Äôre craftspeople and take pride in our efficiency.\n\nAt The Zebra, we have an expectation that developers will squash their commits before merging into `master`. This was not an issue back when we used GitHub for hosting our Git repos. GitHub had useful configuration that allowed admins to enforce squashed commits. All was right with the world. A few folks *really* wanted us to delete our source branches. ü§∑\n\nWe found no such option when we moved over to GitLab. In fact, our developers found an [old GitLab issue](https://gitlab.com/gitlab-org/gitlab/issues/17613) asking for this functionality (2 years old at the time of writing).\n\nWe‚Äôve lived with it for a little over half a year before I decided to look into whether a Chrome extension could solve the problem for us. At least, it could solve it for me.\n\n# The Setup\n\nAt the core of our issue was that the GitLab Merge Request UI had a little checkbox that controlled squashing commits on merge. We simply needed that box to be checked as the Merge Request screen loaded, effectively protecting our squash commit culture by default. Bonus if developers could uncheck the box in case they *really* wanted to include their discrete commits in `master`.\n\nI didn‚Äôt want to read a single bit of Chrome Extension documentation. I actively refused to. It was nearing midnight and I gave myself a 30 minute time limit to make things interesting.\n\nSo I set off to Google how to do this. I found a great article by thoughtbot.. but it was over a few screens worth of scrolling so I decided to just skim the code to see if I could get the gist. I had Netflix to watch, ice cream to eat.\n\n*What‚Äôs to stop you from doing the same thing? Nothing really, go ahead.*\n\n# Making the Extension\n\nI needed exactly two files for my purposes:\n\n```markdown\ngitlab-squash-default\n|- manifest.json (small config for extension)\n`- content.js (the actual browser code)\n```\n\nThe `manifest.json` file is just that; a manifest. This is how Chrome will understand your extension and when to apply it.\n\n---\n\n## manifest.json\n\n```json\n{\n  \"manifest_version\": 2,\n  \"name\": \"GitLab Squash Default\",\n  \"version\": \"0.1\",\n  \"content_scripts\": [\n    {\n      \"matches\": [\"https://gitlab.com/*/merge_requests/*\"],\n      \"js\": [\"content.js\"]\n    }\n  ]\n}\n```\n\nHere‚Äôs a rundown of the most important values.\n\n* `name`: How you‚Äôll recognize your extension when applying it\n* `manifest_version`: This should be set to `2` as the earlier version isn‚Äôt supported. Don‚Äôt ask me why; I skimmed, remember?\n* `content_scripts`: You probably want your extension to run against a single URL or a URL pattern. Set that here. It‚Äôs nice to know that you can use wildcards. My extension is only applied to URLs that begin with `https://gitlab.com/` and must then include `/merge_requests/` in the middle of the path somewhere. I also specify what file runs against those matching URLs.\n\n---\n\n## content.js\n\n```javascript\nwindow.addEventListener('load', () => {\n  checkSquash = setInterval(() => {\n    const checkbox = document.querySelector(\"input[name='squash']\")\n    if (checkbox) {\n      checkbox.checked = true;\n      clearInterval(checkSquash);\n    }\n  }, 250);\n});\n```\n\nAnd that‚Äôs all the JS that I needed to make the functionality. This little code snippet would fire whenever the URL matched GitLab‚Äôs Merge Request screen and the desired checkbox would be checked upon its availability in the DOM. üéâ üéâ üéâ\n\n---\n\n# Enabling the Extension\n\nWith those two files written, follow these steps to enable it for your use:\n\n* Go to `chrome://extensions/` in the Chrome.\n* Enable `Developer mode`. This is a toggle on the top right of the page as of Chrome 80.\n* Click `Load unpacked` and select the directory your files are in.\n* Enable the extension, the name will match what‚Äôs in `manifest.json`.\n* Test it by going to your specified URLs!\n\nIf you don‚Äôt see that the extension is working correctly, check for errors on the extensions page. You can also reload the extension after making changes.\n\n---\n\nThat‚Äôs it, hope that helps you. Feel free to check out my extension if you like. Yep, I‚Äôm hosting my extension for GitLab on GitHub.\n\nI‚Äôd appreciate any comments if you found this useful or entertaining. I‚Äôm looking to start writing more and could use the encouragement. Also, we‚Äôre always [hiring at The Zebra](https://www.thezebra.com/careers/).\n\n## Resources\n\n* [My extension, gitlab-squash-default](https://github.com/johnapost/gitlab-squash-default)\n* [The thoughtbot article I skimmed](https://thoughtbot.com/blog/how-to-make-a-chrome-extension)\n* [The Chrome Extension documentation I never read](https://developer.chrome.com/extensions/devguide)",
  "bodyHtml": "<p><img src=\"hero.jpg\" alt=\"wide: My baby Chrome extension\"></p>\n<p>Honestly, I thought that Chrome extensions were more effort than they were worth to develop. I thought my extension would have to be useful for other people on the Chrome Web Store. Here‚Äôs how I was wrong.</p>\n<p><em>Skip to ‚ÄúMaking the Extension‚Äù if you just want the goods.</em></p>\n<h1>The Use Case</h1>\n<p>I work at <a href=\"https://www.thezebra.com/\">The Zebra</a>. It‚Äôs a neat place with smart software engineers collaborating on interesting problems.</p>\n<p>Any place that has software engineers has people griping and sniping about their tools. We‚Äôre craftspeople and take pride in our efficiency.</p>\n<p>At The Zebra, we have an expectation that developers will squash their commits before merging into <code>master</code>. This was not an issue back when we used GitHub for hosting our Git repos. GitHub had useful configuration that allowed admins to enforce squashed commits. All was right with the world. A few folks <em>really</em> wanted us to delete our source branches. ü§∑</p>\n<p>We found no such option when we moved over to GitLab. In fact, our developers found an <a href=\"https://gitlab.com/gitlab-org/gitlab/issues/17613\">old GitLab issue</a> asking for this functionality (2 years old at the time of writing).</p>\n<p>We‚Äôve lived with it for a little over half a year before I decided to look into whether a Chrome extension could solve the problem for us. At least, it could solve it for me.</p>\n<h1>The Setup</h1>\n<p>At the core of our issue was that the GitLab Merge Request UI had a little checkbox that controlled squashing commits on merge. We simply needed that box to be checked as the Merge Request screen loaded, effectively protecting our squash commit culture by default. Bonus if developers could uncheck the box in case they <em>really</em> wanted to include their discrete commits in <code>master</code>.</p>\n<p>I didn‚Äôt want to read a single bit of Chrome Extension documentation. I actively refused to. It was nearing midnight and I gave myself a 30 minute time limit to make things interesting.</p>\n<p>So I set off to Google how to do this. I found a great article by thoughtbot.. but it was over a few screens worth of scrolling so I decided to just skim the code to see if I could get the gist. I had Netflix to watch, ice cream to eat.</p>\n<p><em>What‚Äôs to stop you from doing the same thing? Nothing really, go ahead.</em></p>\n<h1>Making the Extension</h1>\n<p>I needed exactly two files for my purposes:</p>\n<pre><code class=\"hljs\">gitlab-squash-default\n|- manifest.json (small config for extension)\n`- content.js (the actual browser code)</code></pre><p>The <code>manifest.json</code> file is just that; a manifest. This is how Chrome will understand your extension and when to apply it.</p>\n<hr>\n<h2>manifest.json</h2>\n<pre><code class=\"hljs\">{\n  <span class=\"hljs-attr\">\"manifest_version\"</span>: <span class=\"hljs-number\">2</span>,\n  <span class=\"hljs-attr\">\"name\"</span>: <span class=\"hljs-string\">\"GitLab Squash Default\"</span>,\n  <span class=\"hljs-attr\">\"version\"</span>: <span class=\"hljs-string\">\"0.1\"</span>,\n  <span class=\"hljs-attr\">\"content_scripts\"</span>: [\n    {\n      <span class=\"hljs-attr\">\"matches\"</span>: [<span class=\"hljs-string\">\"https://gitlab.com/*/merge_requests/*\"</span>],\n      <span class=\"hljs-attr\">\"js\"</span>: [<span class=\"hljs-string\">\"content.js\"</span>]\n    }\n  ]\n}</code></pre><p>Here‚Äôs a rundown of the most important values.</p>\n<ul>\n<li><code>name</code>: How you‚Äôll recognize your extension when applying it</li>\n<li><code>manifest_version</code>: This should be set to <code>2</code> as the earlier version isn‚Äôt supported. Don‚Äôt ask me why; I skimmed, remember?</li>\n<li><code>content_scripts</code>: You probably want your extension to run against a single URL or a URL pattern. Set that here. It‚Äôs nice to know that you can use wildcards. My extension is only applied to URLs that begin with <code>https://gitlab.com/</code> and must then include <code>/merge_requests/</code> in the middle of the path somewhere. I also specify what file runs against those matching URLs.</li>\n</ul>\n<hr>\n<h2>content.js</h2>\n<pre><code class=\"hljs\"><span class=\"hljs-built_in\">window</span>.addEventListener(<span class=\"hljs-string\">'load'</span>, () =&gt; {\n  checkSquash = setInterval(<span class=\"hljs-function\"><span class=\"hljs-params\">()</span> =&gt;</span> {\n    <span class=\"hljs-keyword\">const</span> checkbox = <span class=\"hljs-built_in\">document</span>.querySelector(<span class=\"hljs-string\">\"input[name='squash']\"</span>)\n    <span class=\"hljs-keyword\">if</span> (checkbox) {\n      checkbox.checked = <span class=\"hljs-literal\">true</span>;\n      clearInterval(checkSquash);\n    }\n  }, <span class=\"hljs-number\">250</span>);\n});</code></pre><p>And that‚Äôs all the JS that I needed to make the functionality. This little code snippet would fire whenever the URL matched GitLab‚Äôs Merge Request screen and the desired checkbox would be checked upon its availability in the DOM. üéâ üéâ üéâ</p>\n<hr>\n<h1>Enabling the Extension</h1>\n<p>With those two files written, follow these steps to enable it for your use:</p>\n<ul>\n<li>Go to <code>chrome://extensions/</code> in the Chrome.</li>\n<li>Enable <code>Developer mode</code>. This is a toggle on the top right of the page as of Chrome 80.</li>\n<li>Click <code>Load unpacked</code> and select the directory your files are in.</li>\n<li>Enable the extension, the name will match what‚Äôs in <code>manifest.json</code>.</li>\n<li>Test it by going to your specified URLs!</li>\n</ul>\n<p>If you don‚Äôt see that the extension is working correctly, check for errors on the extensions page. You can also reload the extension after making changes.</p>\n<hr>\n<p>That‚Äôs it, hope that helps you. Feel free to check out my extension if you like. Yep, I‚Äôm hosting my extension for GitLab on GitHub.</p>\n<p>I‚Äôd appreciate any comments if you found this useful or entertaining. I‚Äôm looking to start writing more and could use the encouragement. Also, we‚Äôre always <a href=\"https://www.thezebra.com/careers/\">hiring at The Zebra</a>.</p>\n<h2>Resources</h2>\n<ul>\n<li><a href=\"https://github.com/johnapost/gitlab-squash-default\">My extension, gitlab-squash-default</a></li>\n<li><a href=\"https://thoughtbot.com/blog/how-to-make-a-chrome-extension\">The thoughtbot article I skimmed</a></li>\n<li><a href=\"https://developer.chrome.com/extensions/devguide\">The Chrome Extension documentation I never read</a></li>\n</ul>\n",
  "dir": "content",
  "base": "2020-02-17.json",
  "ext": ".json",
  "sourceBase": "2020-02-17.md",
  "sourceExt": ".md"
}